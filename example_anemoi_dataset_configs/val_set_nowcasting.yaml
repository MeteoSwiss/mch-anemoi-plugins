dates:
  start: 2024-09-01T00:00:00Z
  end: 2024-09-01T00:20:00Z
  frequency: 10m
input:
  join:
    - pipe:
        - iconCH1:
            param: [TOT_PREC, U_10M, V_10M, T_2M, TD_2M]
            through: balfrin
            storage_key: val_nowcasting
            resample: 10min
            rename:
                U_10M: U_10M_NWP
                V_10M: V_10M_NWP
                TOT_PREC: TOT_PREC_NWP
                T_2M: T_2M_NWP
                TD_2M: TD_2M_NWP
        - interp2grid:
            template: $file:/users/omiralle/ar-lam-nwc/dataset_configs/inca_template
    - pipe:
        - station:
            param: ["fea010z0", "fna010z0",  rre150z0,  tde200s0,  tre200s0]
            storage_key: val_nowcasting
            rename:
            fea010z0: U_10M_DWH
            fna010z0: V_10M_DWH
            rre150z0: TOT_PREC_DWH
            tde200s0: TD_2M_DWH
            tre200s0: T_2M_DWH
        - interp2grid:
            template: $file:/users/omiralle/ar-lam-nwc/dataset_configs/inca_template
    - pipe:
        - inca:
            param: ["air_temperature", "dew_point_temperature", "wind_speed", "wind_from_direction", "lwe_precipitation_rate"]
            datatype: analysis
            through: gridefix
        - ddff_to_uv:
            u_component: eastward_wind
            v_component: northward_wind
            wind_speed: wind_speed
            wind_direction: wind_from_direction
    - pipe:
        - satellite:
            through: eumetsat
            resample: 10min
            param: [
                HRV,
                IR_016,
                IR_039,
                IR_087,
                IR_097,
                IR_108,
                IR_120,
                IR_134,
                VIS006,
                VIS008,
                WV_062,
                WV_073,
            ]
        - interp2grid:
            template: $file:/users/omiralle/ar-lam-nwc/dataset_configs/inca_template
    - pipe:
        - opera:
            param: [TOT_PREC]
            resample: 10min
        - rename:
            TOT_PREC: TOT_PREC_RADAR
        - interp2grid:
            template: $file:/users/omiralle/ar-lam-nwc/dataset_configs/inca_template
build:
  group_by: daily
  variable_naming: param
  allow_nans: true
